<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Life Data Analysis Part III - Mixture Models • weibulltools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Life Data Analysis Part III - Mixture Models">
<meta property="og:description" content="weibulltools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">weibulltools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Life_Data_Analysis_Part_I.html">Life Data Analysis Part I - Estimation of Failure Probabilities</a>
    </li>
    <li>
      <a href="../articles/Life_Data_Analysis_Part_II.html">Life Data Analysis Part II - Parameter Estimation of Parametric Lifetime Models</a>
    </li>
    <li>
      <a href="../articles/Life_Data_Analysis_Part_III.html">Life Data Analysis Part III - Mixture Models</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Life_Data_Analysis_Part_III_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="Life_Data_Analysis_Part_III_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="Life_Data_Analysis_Part_III_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Life Data Analysis Part III - Mixture Models</h1>
            <h3 class="subtitle">Segmented Regression and EM-Algorithm</h3>
                        <h4 class="author">Tim-Gunnar Hensel</h4>
            
            <h4 class="date">2020-12-16</h4>
      
      
      <div class="hidden name"><code>Life_Data_Analysis_Part_III.Rmd</code></div>

    </div>

    
    
<p>In this vignette two methods for the separation of mixture models are presented. A mixture model can be assumed, if the points in a probability plot show one or more changes in slope, depict one or several saddle points or follow an S-shape. A mixed distribution often represents the combination of multiple failure modes and thus must be splitted in its components to get reasonable results in further analyses.</p>
<p>Segmented regression aims to detect breakpoints in the sample data from whom a split in subgroups can be made. The EM-Algorithm is a computation-intensive method that iteratively tries to maximize a likelihood function, which is weighted by the posterior probability, the conditional probability that an observation belongs to subgroup <em>k</em>.</p>
<p>In the following we will focus on the application of these methods and their visualizations using functions <code><a href="../reference/mixmod_regression.html">mixmod_regression()</a></code>, <code><a href="../reference/mixmod_em.html">mixmod_em()</a></code>, <code><a href="../reference/plot_prob_mix.html">plot_prob_mix()</a></code> and <code><a href="../reference/plot_mod_mix.html">plot_mod_mix()</a></code>, which are implemented in <code>weibulltools</code>.</p>
<div id="data-voltage-stress-test" class="section level2">
<h2 class="hasAnchor">
<a href="#data-voltage-stress-test" class="anchor"></a>Data: Voltage Stress Test</h2>
<p>To apply the introduced methods we will use a dataset where units were passed to a high voltage stress test. <em>hours</em> indicates the number of hours until a failure occurs, or the number of hours until a unit was taken out of the test and has not failed. <em>state</em> is a flag variable and describes the condition of a unit. If a unit failed the flag is 1 and 0 otherwise. Data was taken from <em>Reliability Analysis by Failure Mode</em> <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="probability-plot-for-voltage-stress-test-data" class="section level2">
<h2 class="hasAnchor">
<a href="#probability-plot-for-voltage-stress-test-data" class="anchor"></a>Probability Plot for Voltage Stress Test Data</h2>
<p>To get an intuition whether we can assume the presence of a mixture model, we will construct a Weibull probability plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data: </span>
<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reliability_data.html">reliability_data</a></span><span class="op">(</span><span class="va">voltage</span>, x <span class="op">=</span> <span class="va">hours</span>, status <span class="op">=</span> <span class="va">status</span><span class="op">)</span>

<span class="co"># Estimating failure probabilities: </span>
<span class="va">cdf_john_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_cdf.html">estimate_cdf</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"johnson"</span><span class="op">)</span>

<span class="co"># Probability plot: </span>
<span class="va">weibull_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_prob.html">plot_prob</a></span><span class="op">(</span>
  <span class="va">cdf_john_tbl</span>,
  distribution <span class="op">=</span> <span class="st">"weibull"</span>, 
  title_main <span class="op">=</span> <span class="st">"Weibull Probability Plot"</span>, 
  title_x <span class="op">=</span> <span class="st">"Time in Hours"</span>, 
  title_y <span class="op">=</span> <span class="st">"Probability of Failure in %"</span>,
  title_trace <span class="op">=</span> <span class="st">"Defect Items"</span>,
  plot_method <span class="op">=</span> <span class="st">"ggplot2"</span>
<span class="op">)</span>

<span class="va">weibull_plot</span></code></pre></div>
<div class="figure">
<img src="Life_Data_Analysis_Part_III_files/figure-html/probability%20plot%20weibull-1.png" alt="Figure 1: Plotting positions in weibull grid." width="700"><p class="caption">
Figure 1: Plotting positions in weibull grid.
</p>
</div>
<p><br> Since there is an obvious slope change in the Weibull probability plot of <em>Figure 1</em>, the appearance of a mixture model is strengthened.</p>
</div>
<div id="segmented-regression-with-package-weibulltools" class="section level2">
<h2 class="hasAnchor">
<a href="#segmented-regression-with-package-weibulltools" class="anchor"></a>Segmented Regression with Package <code>weibulltools</code>
</h2>
<p>In package <code>weibulltools</code> the method of segmented regression is implemented in function <code><a href="../reference/mixmod_regression.html">mixmod_regression()</a></code>. If a breakpoint was detected, the failure data is separated by that point. After breakpoint detection the function <code><a href="../reference/rank_regression.html">rank_regression()</a></code> is called inside <code><a href="../reference/mixmod_regression.html">mixmod_regression()</a></code> and is used to estimate the distribution parameters of the subgroups. The visualization of the obtained results is done by functions <code><a href="../reference/plot_prob_mix.html">plot_prob_mix()</a></code> and <code><a href="../reference/plot_mod_mix.html">plot_mod_mix()</a></code>. The produced graph of <code><a href="../reference/plot_prob_mix.html">plot_prob_mix()</a></code> is pretty similar to the graph provided by <code><a href="../reference/plot_prob.html">plot_prob()</a></code>, but the difference is, that the detected subgroups are colored differently. <code><a href="../reference/plot_mod_mix.html">plot_mod_mix()</a></code> then is used to add the estimated regression line of every sub-distribution. In the following the described procedure is expressed with code.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Applying mixmod_regression(): </span>
<span class="va">mixreg_weib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixmod_regression.html">mixmod_regression</a></span><span class="op">(</span><span class="va">cdf_john_tbl</span>, distribution <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span>

<span class="co"># Using plot_prob_mix(). </span>
<span class="va">mix_reg_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_prob.html">plot_prob</a></span><span class="op">(</span>
  <span class="va">mixreg_weib</span>, 
  title_main <span class="op">=</span> <span class="st">"Weibull Mixture Regression"</span>, 
  title_x <span class="op">=</span> <span class="st">"Time in Hours"</span>, 
  title_y <span class="op">=</span> <span class="st">"Probability of Failure"</span>, 
  title_trace <span class="op">=</span> <span class="st">"Subgroup"</span>,
  plot_method <span class="op">=</span> <span class="st">"ggplot2"</span>
<span class="op">)</span>

<span class="va">mix_reg_plot</span></code></pre></div>
<div class="figure">
<img src="Life_Data_Analysis_Part_III_files/figure-html/segmented%20weibull%20I-1.png" alt="Figure 2: Subgroup-specific plotting positions." width="700"><p class="caption">
Figure 2: Subgroup-specific plotting positions.
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using plot_mod() to visualize regression lines of subgroups: </span>
<span class="va">mix_reg_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_mod.html">plot_mod</a></span><span class="op">(</span>
  <span class="va">mix_reg_plot</span>, 
  <span class="va">mixreg_weib</span>, 
  title_trace <span class="op">=</span> <span class="st">"Fitted Line"</span>
<span class="op">)</span>

<span class="va">mix_reg_lines</span></code></pre></div>
<div class="figure">
<img src="Life_Data_Analysis_Part_III_files/figure-html/segmented%20weibull%20II-1.png" alt="Figure 3: Subgroup-specific regression lines." width="700"><p class="caption">
Figure 3: Subgroup-specific regression lines.
</p>
</div>
<p><br> Without specifying the number of mixed components <em>(k)</em> this method has splitted the data in two groups. This can bee seen in <em>Figure 2</em> and <em>Figure 3</em>. To sum up, an upside of this function is that one does not have to specify the number of mixing components, since segmentation happens in an automated fashion. Nevertheless the intention of this function is to give a hint for the existence of a mixture model. An in-depth analysis should be done afterwards.</p>
</div>
<div id="em-algorithm-with-package-weibulltools" class="section level2">
<h2 class="hasAnchor">
<a href="#em-algorithm-with-package-weibulltools" class="anchor"></a>EM-Algorithm with Package <code>weibulltools</code>
</h2>
<p>The EM-Algorithm can be applied through the usage of the function <code><a href="../reference/mixmod_em.html">mixmod_em()</a></code>. In comparison to <code><a href="../reference/mixmod_regression.html">mixmod_regression()</a></code> one has to specify <em>k</em>, the number of subgroups. The obtained results can be visualized by functions <code><a href="../reference/plot_prob_mix.html">plot_prob_mix()</a></code> and <code><a href="../reference/plot_mod_mix.html">plot_mod_mix()</a></code>, too.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Applying mixmod_regression(): </span>
<span class="va">mix_em_weib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixmod_em.html">mixmod_em</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">data</span>, 
  distribution <span class="op">=</span> <span class="st">"weibull"</span>,
  conf_level <span class="op">=</span> <span class="fl">0.95</span>, 
  k <span class="op">=</span> <span class="fl">2</span>, 
  method <span class="op">=</span> <span class="st">"EM"</span>, 
  n_iter <span class="op">=</span> <span class="fl">150</span>
<span class="op">)</span>

<span class="co"># Using plot_prob(): </span>
<span class="va">mix_em_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_prob.html">plot_prob</a></span><span class="op">(</span>
  <span class="va">mix_em_weib</span>,
  title_main <span class="op">=</span> <span class="st">"Weibull Mixture EM"</span>, 
  title_x <span class="op">=</span> <span class="st">"Time in Hours"</span>, 
  title_y <span class="op">=</span> <span class="st">"Probability of Failure"</span>, 
  title_trace <span class="op">=</span> <span class="st">"Subgroup"</span>,
  plot_method <span class="op">=</span> <span class="st">"ggplot2"</span>
<span class="op">)</span>

<span class="va">mix_em_plot</span></code></pre></div>
<div class="figure">
<img src="Life_Data_Analysis_Part_III_files/figure-html/em%20weibull%20I-1.png" alt="Figure 4: Subgroup-specific plotting positions." width="700"><p class="caption">
Figure 4: Subgroup-specific plotting positions.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Using plot_mod() to visualize regression lines of subgroups: </span>
<span class="va">mix_em_lines</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_mod.html">plot_mod</a></span><span class="op">(</span><span class="va">mix_em_plot</span>, <span class="va">mix_em_weib</span>, title_trace <span class="op">=</span> <span class="st">"Fitted Line"</span><span class="op">)</span>
<span class="co">#&gt; Warning: Unknown or uninitialised column: `method`.</span>

<span class="co">#&gt; Warning: Unknown or uninitialised column: `method`.</span>
<span class="va">mix_em_lines</span></code></pre></div>
<div class="figure">
<img src="Life_Data_Analysis_Part_III_files/figure-html/em%20weibull%20II-1.png" alt="Figure 5: Subgroup-specific regression lines." width="700"><p class="caption">
Figure 5: Subgroup-specific regression lines.
</p>
</div>
<p><br> In comparison to <code><a href="../reference/mixmod_regression.html">mixmod_regression()</a></code> the EM-Algorithm can also assign censored items to a specific subgroup. Hence, an individual analysis of the mixing components, depicted in <em>Figure 4</em> and <em>Figure 5</em>, is possible. In conclusion an analysis of a mixture model using <code><a href="../reference/mixmod_em.html">mixmod_em()</a></code> is statistically founded. A drawback of this function is, that the identification of the number of subgroups can not be determined automatically.</p>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Doganaksoy, N.; Hahn, G.; Meeker, W. Q.: <em>Reliability Analysis by Failure Mode</em>, Quality Progress, 35(6), 47-52, 2002<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tim-Gunnar Hensel, David Barkemeyer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
